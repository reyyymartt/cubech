<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Test</title>
  <style type="text/css" media="all">
    #BulletSpawner{
      width: 100%;
      height:50px;
      background-color: gray;
    }
    .drop{
      transition: all 2s;
      transform: scale(10);
    }
  </style>
  <script type="text/javascript" charset="utf-8">
    
    var rand = function(max) {
  return Math.floor(Math.random() * max);
};
   
   
    function moveDown (elem){
      const bg = document.getElementById("BulletSpawner")
      let i = elem.offsetTop
      var interId = null
      var move = function(){
        if (i<=window.innerHeight-50){
          i+=10
          elem.style.top = `${i}px`
        } else {
          var drop = new function(){
            const d = document.createElement("div")
            d.className = "drop"
            d.style.width = "5px"
            d.style.height = "5px"
            d.style.borderRadius="100%"
            d.style.backgroundColor=elem.style.backgroundColor
            d.style.position = "absolute"
            d.style.top = i+"px"
            d.style.left = elem.style.left
            return d
          }
          document.body.appendChild(drop)
          drop.style.transform="scale(10)"
          setTimeout(function(){
            clearInterval(interId)
            drop.remove()
          },100)
          elem.remove()
        }
      }
      interId = setInterval(move, null)
    }
    
    
    window.onload = function(){
      let main = document.getElementById("BulletSpawner")
      const maxSpawn = Infinity
      var spawned = 0
      var interId = null
      const rainWidth = 10
      const rainHeight = 25
      const rain_mps = 200
      const pixel_per_move=1
      const borderR = 50
      
      console.log(window)
      
      var spawnRain= function(div){
        if (spawned<=maxSpawn){
        const elem = document.createElement("div")
        elem.id = `rain_${spawned}`
        elem.style.width=`${rainWidth}px`
        elem.style.height=`${rainHeight}px`
        elem.style.position="absolute"
        elem.style.backgroundColor=`red`
        elem.style.x = `${main.style.top}px`
        elem.style.left=`${rand(main.offsetWidth)}px`
        elem.style.backgroundColor = `rgb(${rand(100)},${rand(100)},${rand(100)},${rand(100)})`
        elem.style.borderRadius=`${borderR}px`
        document.body.appendChild(elem)
        spawned+=pixel_per_move
        new moveDown(elem)
        } else {
          console.log("max rain reached")
          clearInterval(interId)
        }
      }
      interId = setInterval(spawnRain, rain_mps)
    }
  </script>
  <script type="module">
    import imports from "/modules/module.js"
    
    console.log(imports.Earl)
    

  </script>
</head>

<body>
<div id="BulletSpawner">
 
</div>

</body>

</html>